# goa

`goa` is the goa code and documentation generator tool.

## Design

### Meta Generation

The `goa` tool is a meta-generator: it generates code for a generator which then generates the
actual output. This extra step is needed so that the (user) design package gets compiled together
with the code and documentation generation algorithms.

The code generated in the first step (the generator code) is minimal so that all the complex logic
can be implemented and tested in one place: the goa `codegen` package. This initial code simply
implements a bare "main" function which calls "codegen.Main()".

The code in the codegen package uses the design package to traverse the metadata. The path to the
design package in the "imports" directives must be changed prior to compiling the final generator.
This is done by the `goa` tool using [govers](github.com/rogpeppe/govers).

To generate the code `goa` thus:
1. prepares a compilation directory, configuring GOPATH as needed
2. copies the content of `goa/tools/toolgen` and the design package to the compilation directory
3. updates the import directives to the design package to match the compilation directory layout
4. compiles and runs the generator 

### Generation Targets

In its final state the `goa` tool will support the following targets:
* Application source: this is the "main" target, it provides the code needed to implement the
  application controllers. This includes:
* Documentation: this generator generates JSON compatible with what [Praxis](http://praxis-framework.io)
  generates for its documentation.
* Tests: this generator creates component level tests covering all the controller actions. These
  tests call each handler with randomly generated arguments and validate the response written by
  the handlers.
* Client: this generator produces client code for the application. This includes both a Go package
  and a command line tool.

The initial focus is on the first two targets.

#### AppGen

The AppGen tool is the tool that generates the application code (the first bullet in the list
above). The code generated by AppGen is all generated in an `autogen` package and consists of
three files:
* resources.go: contains struct types describing the API resources and action payloads.
* handlers.go: contains functions that decode the request parameters, call the user code and encode the responses.
* contexts.go: contains wrappers around the request parameters that provide typed access and helper functions to generate the response contents.

## Usage

TBD
